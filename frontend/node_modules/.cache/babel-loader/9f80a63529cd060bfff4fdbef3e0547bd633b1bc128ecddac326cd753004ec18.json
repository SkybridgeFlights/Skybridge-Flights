{"ast":null,"code":"// frontend/src/components/Sidebar.js\nimport React,{useEffect,useState}from'react';import{Link,useNavigate,useLocation}from'react-router-dom';import'./Sidebar.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Sidebar(_ref){let{menuOpen,toggleMenu}=_ref;const[user,setUser]=useState(null);const navigate=useNavigate();const location=useLocation();// دالة لتحديث حالة المستخدم من LocalStorage\nconst updateUserState=()=>{try{const storedUser=localStorage.getItem('user');setUser(storedUser?JSON.parse(storedUser):null);}catch(error){console.error('Error parsing user data:',error);localStorage.removeItem('user');setUser(null);}};// تحديث عند أي تغيير للمسار (URL) أو عند إطلاق حدث userStateChange\nuseEffect(()=>{updateUserState();const handleUserChange=()=>updateUserState();window.addEventListener('userStateChange',handleUserChange);return()=>{window.removeEventListener('userStateChange',handleUserChange);};},[location.pathname]);const isAdmin=(user===null||user===void 0?void 0:user.email)==='SkybridgeFlights@gmail.com';const isCustomer=user&&!isAdmin;const logout=()=>{localStorage.removeItem('user');setUser(null);// إطلاق الحدث لتحديث Sidebar فوراً\nwindow.dispatchEvent(new Event('userStateChange'));navigate('/login');};const showBackButton=!['/','/login','/register','/staff-login'].includes(location.pathname);const handleGoBack=()=>{navigate(-1);toggleMenu();};const handleLinkClick=()=>{toggleMenu();// إطلاق الحدث للتأكد من تحديث القائمة\nwindow.dispatchEvent(new Event('userStateChange'));};return/*#__PURE__*/_jsxs(\"aside\",{className:`sidebar ${menuOpen?'open':''}`,children:[showBackButton&&/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:handleGoBack,children:\"\\u2190 Back\"}),/*#__PURE__*/_jsx(\"nav\",{className:\"sidebar-nav\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[user&&/*#__PURE__*/_jsx(\"li\",{className:\"sidebar-user\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[/*#__PURE__*/_jsx(\"strong\",{children:user.name||\"User\"}),/*#__PURE__*/_jsx(\"span\",{children:user.email})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",onClick:handleLinkClick,children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/flights\",onClick:handleLinkClick,children:\"Search Flights\"})}),isCustomer&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/user-profile\",onClick:handleLinkClick,children:\"My Profile\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/bookings\",onClick:handleLinkClick,children:\"My Bookings\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/visa\",onClick:handleLinkClick,children:\"Visa Application\"})})]}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/passport-queue\",onClick:handleLinkClick,children:\"Syrian Passport Queue\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/about\",onClick:handleLinkClick,children:\"About Us\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/contact\",onClick:handleLinkClick,children:\"Contact Us\"})}),!user&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/login\",onClick:handleLinkClick,children:\"Login\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/register\",onClick:handleLinkClick,children:\"Register\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/staff-login\",onClick:handleLinkClick,children:\"Staff Login\"})})]}),isAdmin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin\",onClick:handleLinkClick,children:\"Admin Panel\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/manage-staff\",onClick:handleLinkClick,children:\"Manage Staff\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/view-visas\",onClick:handleLinkClick,children:\"Visa Applications\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/admin/view-bookings\",onClick:handleLinkClick,children:\"All Bookings\"})})]}),user&&/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:logout,className:\"logout-button\",children:\"Logout\"})})]})})]});}export default Sidebar;","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Sidebar","_ref","menuOpen","toggleMenu","user","setUser","navigate","location","updateUserState","storedUser","localStorage","getItem","JSON","parse","error","console","removeItem","handleUserChange","window","addEventListener","removeEventListener","pathname","isAdmin","email","isCustomer","logout","dispatchEvent","Event","showBackButton","includes","handleGoBack","handleLinkClick","className","children","onClick","name","to"],"sources":["C:/Users/Wajd Shaaban/OneDrive/Desktop/SkybridgeFlights/frontend/src/components/Sidebar.js"],"sourcesContent":["// frontend/src/components/Sidebar.js\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\r\nimport './Sidebar.css';\r\n\r\nfunction Sidebar({ menuOpen, toggleMenu }) {\r\n  const [user, setUser] = useState(null);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  // دالة لتحديث حالة المستخدم من LocalStorage\r\n  const updateUserState = () => {\r\n    try {\r\n      const storedUser = localStorage.getItem('user');\r\n      setUser(storedUser ? JSON.parse(storedUser) : null);\r\n    } catch (error) {\r\n      console.error('Error parsing user data:', error);\r\n      localStorage.removeItem('user');\r\n      setUser(null);\r\n    }\r\n  };\r\n\r\n  // تحديث عند أي تغيير للمسار (URL) أو عند إطلاق حدث userStateChange\r\n  useEffect(() => {\r\n    updateUserState();\r\n\r\n    const handleUserChange = () => updateUserState();\r\n\r\n    window.addEventListener('userStateChange', handleUserChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('userStateChange', handleUserChange);\r\n    };\r\n  }, [location.pathname]);\r\n\r\n  const isAdmin = user?.email === 'SkybridgeFlights@gmail.com';\r\n  const isCustomer = user && !isAdmin;\r\n\r\n  const logout = () => {\r\n    localStorage.removeItem('user');\r\n    setUser(null);\r\n\r\n    // إطلاق الحدث لتحديث Sidebar فوراً\r\n    window.dispatchEvent(new Event('userStateChange'));\r\n\r\n    navigate('/login');\r\n  };\r\n\r\n  const showBackButton = !['/', '/login', '/register', '/staff-login'].includes(location.pathname);\r\n\r\n  const handleGoBack = () => {\r\n    navigate(-1);\r\n    toggleMenu();\r\n  };\r\n\r\n  const handleLinkClick = () => {\r\n    toggleMenu();\r\n    // إطلاق الحدث للتأكد من تحديث القائمة\r\n    window.dispatchEvent(new Event('userStateChange'));\r\n  };\r\n\r\n  return (\r\n    <aside className={`sidebar ${menuOpen ? 'open' : ''}`}>\r\n      {showBackButton && (\r\n        <button className=\"back-button\" onClick={handleGoBack}>← Back</button>\r\n      )}\r\n      <nav className=\"sidebar-nav\">\r\n        <ul>\r\n          {user && (\r\n            <li className=\"sidebar-user\">\r\n              <div className=\"user-info\">\r\n                <strong>{user.name || \"User\"}</strong>\r\n                <span>{user.email}</span>\r\n              </div>\r\n            </li>\r\n          )}\r\n          <li><Link to=\"/\" onClick={handleLinkClick}>Home</Link></li>\r\n          <li><Link to=\"/flights\" onClick={handleLinkClick}>Search Flights</Link></li>\r\n          {isCustomer && (\r\n            <>\r\n              <li><Link to=\"/user-profile\" onClick={handleLinkClick}>My Profile</Link></li>\r\n              <li><Link to=\"/bookings\" onClick={handleLinkClick}>My Bookings</Link></li>\r\n              <li><Link to=\"/visa\" onClick={handleLinkClick}>Visa Application</Link></li>\r\n            </>\r\n          )}\r\n\r\n          {/* رابط تسجيل الدور لجوازات السفر السورية */}\r\n          <li><Link to=\"/passport-queue\" onClick={handleLinkClick}>Syrian Passport Queue</Link></li>\r\n\r\n          <li><Link to=\"/about\" onClick={handleLinkClick}>About Us</Link></li>\r\n          <li><Link to=\"/contact\" onClick={handleLinkClick}>Contact Us</Link></li>\r\n          {!user && (\r\n            <>\r\n              <li><Link to=\"/login\" onClick={handleLinkClick}>Login</Link></li>\r\n              <li><Link to=\"/register\" onClick={handleLinkClick}>Register</Link></li>\r\n              <li><Link to=\"/staff-login\" onClick={handleLinkClick}>Staff Login</Link></li>\r\n            </>\r\n          )}\r\n          {isAdmin && (\r\n            <>\r\n              <li><Link to=\"/admin\" onClick={handleLinkClick}>Admin Panel</Link></li>\r\n              <li><Link to=\"/admin/manage-staff\" onClick={handleLinkClick}>Manage Staff</Link></li>\r\n              <li><Link to=\"/admin/view-visas\" onClick={handleLinkClick}>Visa Applications</Link></li>\r\n              <li><Link to=\"/admin/view-bookings\" onClick={handleLinkClick}>All Bookings</Link></li>\r\n            </>\r\n          )}\r\n          {user && (\r\n            <li>\r\n              <button onClick={logout} className=\"logout-button\">Logout</button>\r\n            </li>\r\n          )}\r\n        </ul>\r\n      </nav>\r\n    </aside>\r\n  );\r\n}\r\n\r\nexport default Sidebar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}