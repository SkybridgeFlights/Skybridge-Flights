{"ast":null,"code":"// frontend/src/pages/LoginPage.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate,Link}from'react-router-dom';import{API_BASE_URL}from'../apiConfig';import'./LoginPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function LoginPage(){const navigate=useNavigate();const[formData,setFormData]=useState({email:'',password:''});const[message,setMessage]=useState('');const[submitting,setSubmitting]=useState(false);// ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ≥ÿ¨ŸÑ ÿØÿÆŸàŸÑ ŸÖÿ≥ÿ®ŸÇÿßŸã\nuseEffect(()=>{try{const userStr=localStorage.getItem('user');if(userStr){const parsed=JSON.parse(userStr);if(parsed&&parsed.email){console.log(\"üîπ User already logged in:\",parsed);navigate('/user-profile');}}}catch(error){console.error(\"Error parsing user data from localStorage:\",error);}},[navigate]);const handleChange=e=>setFormData(prev=>({...prev,[e.target.name]:e.target.value}));const handleSubmit=async e=>{e.preventDefault();setMessage('');setSubmitting(true);console.log(\"üîπ Attempting login with:\",formData);try{const{data}=await axios.post(`${API_BASE_URL}/api/users/login`,formData);console.log(\"üîπ Response data:\",data);if(!data||!data.user||!data.token){throw new Error('Unexpected server response');}// ÿ≠ŸÅÿ∏ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàÿßŸÑÿ™ŸàŸÉŸÜ ÿØÿßÿÆŸÑ ŸÜŸÅÿ≥ ÿßŸÑŸÉÿßÿ¶ŸÜ\nconst userWithToken={...data.user,token:data.token};localStorage.setItem('user',JSON.stringify(userWithToken));localStorage.setItem('token',data.token);// ‚úÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ®ÿ¥ŸÉŸÑ ŸÖŸÜŸÅÿµŸÑ\n// ÿ∂ÿ®ÿ∑ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ®ÿ¥ŸÉŸÑ ÿπÿßŸÖ ŸÑŸÉŸÑ ÿ∑ŸÑÿ®ÿßÿ™ Axios\naxios.defaults.headers.common['Authorization']=`Bearer ${data.token}`;setMessage('‚úÖ Login successful');// ÿ•ÿ±ÿ≥ÿßŸÑ ÿ≠ÿØÿ´ ŸÑÿ™ÿ≠ÿØŸäÿ´ Sidebar ŸÅŸàÿ±ÿßŸã\nwindow.dispatchEvent(new Event('userStateChange'));navigate('/user-profile');}catch(err){var _err$response;console.error(\"Login error:\",err);const status=err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status;if(status===403){setMessage('‚ùå Please verify your email first.');}else if(status===401){setMessage('‚ùå Invalid email or password.');}else{setMessage(`‚ùå Login failed: ${err===null||err===void 0?void 0:err.message}`);}}finally{setSubmitting(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"login-box\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"login-title\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:\"Email\",value:formData.email,onChange:handleChange,required:true,className:\"login-input\",autoComplete:\"email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:\"Password\",value:formData.password,onChange:handleChange,required:true,className:\"login-input\",autoComplete:\"current-password\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"login-button\",disabled:submitting,children:submitting?'Logging in‚Ä¶':'Login'}),/*#__PURE__*/_jsx(\"div\",{className:\"forgot-password-link\",children:/*#__PURE__*/_jsx(Link,{to:\"/forgot-password\",children:\"Forgot your password?\"})}),message&&/*#__PURE__*/_jsx(\"p\",{className:\"login-message\",children:message})]})]})});}export default LoginPage;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","Link","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","LoginPage","navigate","formData","setFormData","email","password","message","setMessage","submitting","setSubmitting","userStr","localStorage","getItem","parsed","JSON","parse","console","log","error","handleChange","e","prev","target","name","value","handleSubmit","preventDefault","data","post","user","token","Error","userWithToken","setItem","stringify","defaults","headers","common","window","dispatchEvent","Event","err","_err$response","status","response","className","children","onSubmit","noValidate","type","placeholder","onChange","required","autoComplete","disabled","to"],"sources":["C:/Users/Wajd Shaaban/OneDrive/Desktop/SkybridgeFlights/frontend/src/pages/LoginPage.js"],"sourcesContent":["// frontend/src/pages/LoginPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport { API_BASE_URL } from '../apiConfig';\r\nimport './LoginPage.css';\r\n\r\nfunction LoginPage() {\r\n  const navigate = useNavigate();\r\n  const [formData, setFormData] = useState({ email: '', password: '' });\r\n  const [message, setMessage] = useState('');\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÖÿ≥ÿ¨ŸÑ ÿØÿÆŸàŸÑ ŸÖÿ≥ÿ®ŸÇÿßŸã\r\n  useEffect(() => {\r\n    try {\r\n      const userStr = localStorage.getItem('user');\r\n      if (userStr) {\r\n        const parsed = JSON.parse(userStr);\r\n        if (parsed && parsed.email) {\r\n          console.log(\"üîπ User already logged in:\", parsed);\r\n          navigate('/user-profile');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error parsing user data from localStorage:\", error);\r\n    }\r\n  }, [navigate]);\r\n\r\n  const handleChange = (e) =>\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [e.target.name]: e.target.value,\r\n    }));\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setMessage('');\r\n    setSubmitting(true);\r\n\r\n    console.log(\"üîπ Attempting login with:\", formData);\r\n\r\n    try {\r\n      const { data } = await axios.post(\r\n        `${API_BASE_URL}/api/users/login`,\r\n        formData\r\n      );\r\n\r\n      console.log(\"üîπ Response data:\", data);\r\n\r\n      if (!data || !data.user || !data.token) {\r\n        throw new Error('Unexpected server response');\r\n      }\r\n\r\n      // ÿ≠ŸÅÿ∏ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸàÿßŸÑÿ™ŸàŸÉŸÜ ÿØÿßÿÆŸÑ ŸÜŸÅÿ≥ ÿßŸÑŸÉÿßÿ¶ŸÜ\r\n      const userWithToken = { ...data.user, token: data.token };\r\n      localStorage.setItem('user', JSON.stringify(userWithToken));\r\n      localStorage.setItem('token', data.token); // ‚úÖ ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ®ÿ¥ŸÉŸÑ ŸÖŸÜŸÅÿµŸÑ\r\n\r\n      // ÿ∂ÿ®ÿ∑ ÿßŸÑÿ™ŸàŸÉŸÜ ÿ®ÿ¥ŸÉŸÑ ÿπÿßŸÖ ŸÑŸÉŸÑ ÿ∑ŸÑÿ®ÿßÿ™ Axios\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${data.token}`;\r\n\r\n      setMessage('‚úÖ Login successful');\r\n\r\n      // ÿ•ÿ±ÿ≥ÿßŸÑ ÿ≠ÿØÿ´ ŸÑÿ™ÿ≠ÿØŸäÿ´ Sidebar ŸÅŸàÿ±ÿßŸã\r\n      window.dispatchEvent(new Event('userStateChange'));\r\n\r\n      navigate('/user-profile');\r\n    } catch (err) {\r\n      console.error(\"Login error:\", err);\r\n\r\n      const status = err?.response?.status;\r\n      if (status === 403) {\r\n        setMessage('‚ùå Please verify your email first.');\r\n      } else if (status === 401) {\r\n        setMessage('‚ùå Invalid email or password.');\r\n      } else {\r\n        setMessage(`‚ùå Login failed: ${err?.message}`);\r\n      }\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-container\">\r\n      <div className=\"login-box\">\r\n        <h2 className=\"login-title\">Login</h2>\r\n        <form onSubmit={handleSubmit} noValidate>\r\n          <input\r\n            type=\"email\"\r\n            name=\"email\"\r\n            placeholder=\"Email\"\r\n            value={formData.email}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"login-input\"\r\n            autoComplete=\"email\"\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            name=\"password\"\r\n            placeholder=\"Password\"\r\n            value={formData.password}\r\n            onChange={handleChange}\r\n            required\r\n            className=\"login-input\"\r\n            autoComplete=\"current-password\"\r\n          />\r\n          <button type=\"submit\" className=\"login-button\" disabled={submitting}>\r\n            {submitting ? 'Logging in‚Ä¶' : 'Login'}\r\n          </button>\r\n          <div className=\"forgot-password-link\">\r\n            <Link to=\"/forgot-password\">Forgot your password?</Link>\r\n          </div>\r\n          {message && <p className=\"login-message\">{message}</p>}\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}